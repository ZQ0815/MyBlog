# TCP与UDP
## 传输层的作用
>让本机的端口与服务器的指定端口建立链接和断开链接。

## TCP
>TCP是面向链接的、可靠的流协议。
- 特点
1. 通过检验和、序列号、确认应答、重发控制、链接管理以及窗口控制等实现可靠性传输。
### 序列号和确认应答号
当发送端的数据到达接收主机时，接收端主机会返回一个已收到消息的通知。
### 重发超时如何确定
重发超时要考虑往返时间又要考虑网络环境带来的偏差。在任何环境下都要保证流量控制，不要浪费网络流量。
- 超时重发一般设置为6S，如果重发还是接受不到会继续重发等待应答的时间也会以指数函数的方式增加。
- 超过一定次数之后会强制关闭。
### TCP中以段为单位发送数据
在建立TCP连接时，也可以确定发送数据包的单位，即最大消息长度。
- 缺点：
1. 包往返时间越长通信性能越低。
### 利用窗口控制提高速度
>确认应答不再是以每个分段，而是以更大的单位来进行确认。
#### 窗口
>无需等待确认应答而可以继续发送数据的最大值。同时添加缓冲区保留窗口中的数据。
#### 滑动窗口
![滑动窗口](../img/TCP-IP/滑动窗口.png)
#### 高速重发控制
![高速重发控制](../img/TCP-IP/高速重发控制.png)
### 流控制
>TCP提供一种机制可以让发送端根据接收端的实际接受能力控制发送的数据量。具体实现就是接收端向发送端主机通知自己可以接受数据的大小。
### 拥塞控制
>问题背景：防止在网络拥堵的情况下发送较大量的数据，导致网络瘫痪。
>通信开始通过一个慢启动的算法得出的数值，对发送的数据进行控制。
![拥塞控制](../img/拥塞控制.png)
### 慢启动算法
>初始时将窗口大小设为1，随着包的往返，以指数函数增长。当超过慢启动阈值时采用如下计算方式：
![慢启动阈值计算](../img/慢启动算法.png)

### 提高网络利用率的算法
- Nagle算法
- 延迟确认应答
- 捎带应答



## UDP
>UDP是不具有可靠性的数据报协议。
### UDP的特点和目的
- 特点
1. 面向无连接
2. 可以随时发送数据
3. UDP本身处理简单高效

- 使用场景
1. 包总量较少的通信DNS、SNMP
2. 视频、音频等多媒体通信
3. 广播通信

## TCP与UDP的使用场景区别
1） TCP提供面向连接的传输，通信前要先建立连接（三次握手机制）； UDP提供无连接的传输，通信前不需要建立连接。
2） TCP提供可靠的传输（有序，无差错，不丢失，不重复）； UDP提供不可靠的传输。
3） TCP面向字节流的传输，因此它能将信息分割成组，并在接收端将其重组； UDP是面向数据报的传输，没有分组开销。
4） TCP提供拥塞控制和流量控制机制； UDP不提供拥塞控制和流量控制机制。
![TCP-UDP区别](../img/TCP-UDP区别.png)
![TCP与UDP的使用场景](../img/TCP与UDP的使用场景.png)
>[参考文献](https://blog.csdn.net/striveb/article/details/84063712?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1)